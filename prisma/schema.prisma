generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider     = "mysql"
  url          = env("DATABASE_URL")
  relationMode = "prisma"
}

model auth_base_user {
  id             String                 @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  user_name      String?                @unique(map: "auth_base_user_pk") @db.VarChar(255)
  full_name      String?                @db.VarChar(255)
  email          String?                @db.VarChar(255)
  phone_number   String?                @db.Char(10)
  password_hash  String?                @db.VarChar(255)
  address        String?                @db.VarChar(255)
  description    String?                @db.VarChar(255)
  latest_login   DateTime?              @db.Timestamp(0)
  login_attempts Int?
  lockout_util   DateTime?              @db.Timestamp(0)
  status         auth_base_user_status? @default(INACTIVE)
  created_at     DateTime?              @default(now()) @db.Timestamp(0)
  updated_at     DateTime?              @default(now()) @db.Timestamp(0)
  group_id       String?                @db.VarChar(36)
  last_seen_at   DateTime?              @db.Timestamp(0)

  @@index([email], map: "idx_email")
  @@index([last_seen_at], map: "idx_last_seen")
  @@index([status], map: "idx_status")
}

model auth_refresh_tokens {
  id         String    @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  token_id   String?   @unique(map: "token_id") @db.VarChar(255)
  token_hash String?   @db.VarChar(255)
  user_id    String?   @db.VarChar(36)
  expires_at DateTime? @db.Timestamp(0)
  revoked_at DateTime? @db.Timestamp(0)
  ip_address String?   @db.VarChar(45)
  user_agent String?   @db.Text
  created_at DateTime? @default(now()) @db.Timestamp(0)
  updated_at DateTime? @default(now()) @db.Timestamp(0)

  @@index([expires_at], map: "idx_expires")
  @@index([revoked_at], map: "idx_revoked")
  @@index([token_id], map: "idx_token_id")
  @@index([user_id], map: "idx_user")
  @@index([user_id, expires_at], map: "idx_user_expires")
}

model system_setting {
  id            String    @id @default(dbgenerated("(uuid())")) @db.VarChar(36)
  name_setting  String?   @unique(map: "system_setting_pk") @db.VarChar(255)
  value_setting String?   @db.VarChar(255)
  created_at    DateTime? @default(now()) @db.Timestamp(0)
  updated_at    DateTime? @default(now()) @db.Timestamp(0)
}

enum auth_base_user_status {
  ACTIVE
  INACTIVE
  BANNER
}
